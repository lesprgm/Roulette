{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/schemas/page.schema.json",
  "title": "Web Page",
  "description": "Strict schema for a generated web page description and content blocks.",
  "type": "object",
  "additionalProperties": false,
  "required": ["version", "meta", "layout", "sections"],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^v\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version for the page format, e.g. v1.0.0"
    },
    "meta": {
      "type": "object",
      "additionalProperties": false,
      "required": ["title", "description", "language"],
      "properties": {
        "title": { "type": "string", "minLength": 1 },
        "description": { "type": "string" },
        "language": { "type": "string", "pattern": "^[a-z]{2}(-[A-Z]{2})?$" },
        "tags": {
          "type": "array",
          "items": { "type": "string" },
          "uniqueItems": true
        },
        "author": {
          "type": "object",
          "additionalProperties": false,
          "required": ["name"],
          "properties": {
            "name": { "type": "string", "minLength": 1 },
            "url": { "type": "string", "format": "uri" },
            "email": { "type": "string", "format": "email" }
          }
        }
      }
    },
    "layout": {
      "type": "object",
      "additionalProperties": false,
      "required": ["theme", "containerWidth"],
      "properties": {
        "theme": { "type": "string", "enum": ["light", "dark", "auto"] },
        "containerWidth": { "type": "string", "enum": ["sm", "md", "lg", "xl", "full"] },
        "navigation": {
          "type": "object",
          "additionalProperties": false,
          "required": ["items"],
          "properties": {
            "items": {
              "type": "array",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": ["label", "href"],
                "properties": {
                  "label": { "type": "string" },
                  "href": { "type": "string", "pattern": "^#|/|https?://" },
                  "external": { "type": "boolean", "default": false }
                }
              }
            }
          }
        },
        "footer": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "text": { "type": "string" },
            "links": {
              "type": "array",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": ["label", "href"],
                "properties": {
                  "label": { "type": "string" },
                  "href": { "type": "string", "pattern": "^#|/|https?://" }
                }
              }
            }
          }
        }
      }
    },
  "sections": {
      "type": "array",
      "minItems": 1,
      "items": {
        "oneOf": [
      { "$ref": "#/definitions/heroSection" },
      { "$ref": "#/definitions/featureGridSection" },
      { "$ref": "#/definitions/contentSection" },
      { "$ref": "#/definitions/ctaSection" }
        ]
      }
    }
  },
  "definitions": {
    "baseSection": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "type"],
      "properties": {
        "id": { "type": "string", "pattern": "^[a-zA-Z0-9_-]+$" },
        "type": { "type": "string" },
        "background": { "type": "string", "enum": ["default", "muted", "primary", "inverted"] }
      }
    },
    "heroSection": {
      "allOf": [
    { "$ref": "#/definitions/baseSection" },
        {
          "type": "object",
          "properties": {
            "type": { "const": "hero" },
            "headline": { "type": "string", "minLength": 1 },
            "subheadline": { "type": "string" },
      "primaryAction": { "$ref": "#/definitions/action" },
      "secondaryAction": { "$ref": "#/definitions/action" },
      "image": { "$ref": "#/definitions/image" }
          },
          "required": ["type", "headline"],
          "additionalProperties": false
        }
      ]
    },
    "featureGridSection": {
      "allOf": [
    { "$ref": "#/definitions/baseSection" },
        {
          "type": "object",
          "properties": {
            "type": { "const": "feature-grid" },
            "title": { "type": "string" },
            "columns": { "type": "integer", "minimum": 1, "maximum": 4, "default": 3 },
            "items": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": ["icon", "title", "text"],
                "properties": {
                  "icon": { "type": "string" },
                  "title": { "type": "string" },
                  "text": { "type": "string" }
                }
              }
            }
          },
          "required": ["type", "items"],
          "additionalProperties": false
        }
      ]
    },
    "contentSection": {
      "allOf": [
    { "$ref": "#/definitions/baseSection" },
        {
          "type": "object",
          "properties": {
            "type": { "const": "content" },
            "title": { "type": "string" },
            "body": { "type": "string", "description": "Markdown content" },
            "align": { "type": "string", "enum": ["left", "center", "right"], "default": "left" },
      "image": { "$ref": "#/definitions/image" }
          },
          "required": ["type", "body"],
          "additionalProperties": false
        }
      ]
    },
    "ctaSection": {
      "allOf": [
    { "$ref": "#/definitions/baseSection" },
        {
          "type": "object",
          "properties": {
            "type": { "const": "cta" },
            "title": { "type": "string" },
            "text": { "type": "string" },
      "action": { "$ref": "#/definitions/action" }
          },
          "required": ["type", "title", "action"],
          "additionalProperties": false
        }
      ]
    },
    "image": {
      "type": "object",
      "additionalProperties": false,
      "required": ["src", "alt"],
      "properties": {
        "src": { "type": "string", "format": "uri-reference" },
        "alt": { "type": "string" },
        "width": { "type": "integer", "minimum": 1 },
        "height": { "type": "integer", "minimum": 1 }
      }
    },
    "action": {
      "type": "object",
      "additionalProperties": false,
      "required": ["label", "href"],
      "properties": {
  "label": { "type": "string" },
  "href": { "type": "string", "pattern": "^(#|/|https?://)" },
        "style": { "type": "string", "enum": ["primary", "secondary", "link"] }
      }
    }
  }
}
